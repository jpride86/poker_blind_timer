<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Poker Blind Timer</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#121212">
  <link rel="apple-touch-icon" href="icon.png">
  <style>
  body {
    font-family: sans-serif;
    text-align: center;
    background: #121212;
    color: white;
    padding: 30px;
    transition: background-color 0.5s ease;
  }

  .flash {
    animation: flashRed 1s alternate infinite;
  }

  .celebrate {
    animation: rainbow 0.5s infinite alternate;
  }

  @keyframes flashRed {
    from { background-color: #121212; }
    to { background-color: red; }
  }

  @keyframes rainbow {
    0% { background-color: red; }
    20% { background-color: orange; }
    40% { background-color: yellow; }
    60% { background-color: green; }
    80% { background-color: blue; }
    100% { background-color: violet; }
  }

  .timer {
    font-size: 3em;
    margin: 20px 0;
  }

  .level {
    font-size: 2em;
    margin-bottom: 10px;
  }

  button, input, select {
    display: block;
    padding: 10px 20px;
    font-size: 1em;
    margin: 10px auto;
    width: 90%;
    max-width: 300px;
    box-sizing: border-box;
  }

  .player-section {
    margin: 20px 0;
  }

  #playerList, #knockoutLog, #blindList, #payoutList {
    margin-top: 10px;
    list-style: none;
    padding: 0;
  }

  #playerList li, #knockoutLog li, #blindList li {
    margin: 8px 0;
  }

  .buyin-button, .knockout-button, .delete-button {
    display: inline-block;
    margin-left: 10px;
    width: auto;
  }

  .eliminated {
  opacity: 0.5;
  text-decoration: line-through;
  pointer-events: none;
}


  #blindSetup {
    margin-bottom: 20px;
  }

  
  #confetti-canvas {
    position: fixed;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 9999;
  }
#buyInValue {
  text-align: center;
  font-size: 1em;
  max-width: 200px;
}
  #buyInValue,
#smallBlind,
#bigBlind,
#duration {
  text-align: center;
  margin: 0 auto;
  display: block;
}
#savedPlayers,
#playerName {
  text-align: center;
  margin: 0 auto;
  display: block;
}
#startBtn {
  background-color: #28a745;  /* Green */
  color: white;
}

#pauseBtn {
  background-color: #ffc107;  /* Yellow */
  color: black;
}

#resetBtn {
  background-color: #007bff;  /* Blue */
  color: white;
}

/* Optional hover effect */
#startBtn:hover {
  background-color: #218838;
}
#pauseBtn:hover {
  background-color: #e0a800;
}
#resetBtn:hover {
  background-color: #0069d9;
}
.knockout-button {
  background-color: #dc3545;  /* Bootstrap-style Red */
  color: white;
}

/* Optional hover effect */
.knockout-button:hover {
  background-color: #c82333;
}
.default-button {
  background-color: #444;  /* Dark Gray */
  color: white;
  border: none;
}

.default-button:hover {
  background-color: #555;
}
/* Re-buy button: neutral gray */
.buyin-button {
  background-color: #555;
  color: white;
  border: none;
}

.buyin-button:hover {
  background-color: #666;
}

/* Knock Out / Undo KO: red */
.knockout-button {
  background-color: #b00020;
  color: white;
  border: none;
}

.knockout-button:hover {
  background-color: #d32f2f;
}

/* Delete blind level: dark red */
.delete-button {
  background-color: #7b1fa2;
  color: white;
  border: none;
}

.delete-button:hover {
  background-color: #9c27b0;
}
#playerList li span,
#playerList li label,
#playerList li button {
  display: inline-block;
  vertical-align: middle;
  margin-left: 8px;
}

</style>

</head>
<body>
  <canvas id="confetti-canvas"></canvas>
  <audio id="whistleSound" src="https://cdn.pixabay.com/audio/2022/03/15/audio_005eb8bfc8.mp3" preload="auto"></audio>
  <audio id="winSound" src="https://actions.google.com/sounds/v1/alarms/bugle_tune.ogg" preload="auto"></audio>

  <h1>Poker Blind Timer</h1>

<button class="default-button" onclick="clearAllInputs()">Clear All Inputs</button>


 <div id="buyinSetup" class="player-section">
  <h2>Set Buy-In Amount</h2>
  <div class="inline-group">
    <input type="number" id="buyInValue" placeholder="Buy-In ($)" onchange="saveInputs()" />
      </div>
</div>



<div class="player-section">
  <h2>Blind Levels</h2>

  <button class="default-button" onclick="loadStandardPreset()">Use Standard Structure</button>

 <div id="blindSetup">
  <input type="number" id="smallBlind" placeholder="Small Blind" onchange="saveInputs()" />
<input type="number" id="bigBlind" placeholder="Big Blind" onchange="saveInputs()" />
<input type="number" id="duration" placeholder="Duration (min)" onchange="saveInputs()" />
<input type="number" id="dealerFeeInput" placeholder="Dealer Fee ($)" onchange="saveInputs()" />

   <button class="default-button" onclick="addBlindLevel()">Add Level</button>
</div>
<div class="player-section">
  <h2>Dealer Setup</h2>
  <input type="number" id="dealerFeeDealer" placeholder="Dealer Fee ($)" />
  <div id="dealerSelect"></div>
  <button class="default-button" onclick="calculateDealerSplit()">Calculate Dealer Split</button>
  <div id="dealerResult" style="margin-top: 10px; font-weight: bold;"></div>
</div>

  <button id="toggleCustomBtn" class="default-button" onclick="toggleCustomBlind()">Hide Custom Blind Setup</button>
  
  <ul id="blindList"></ul>
</div>

<div class="player-section">
<h2>Players</h2>

<!-- Dropdown First -->
<div style="margin-bottom: 15px;">
  <label for="savedPlayers"><strong>Select Saved Player:</strong></label><br>
  <select id="savedPlayers" onchange="addSavedPlayer()">
    <option value="">-- Select Saved Player --</option>
    <option value="Andrew">Andrew</option>
    <option value="Cristian">Cristian</option>
    <option value="Dan">Dan</option>
    <option value="Eddie">Eddie</option>
    <option value="Eduardo">Eduardo</option>
    <option value="FrÃ©d">FrÃ©d</option>
    <option value="Jamie">Jamie</option>
    <option value="Jason">Jason</option>
    <option value="Jeffrey J">Jeffrey J</option>
    <option value="Jeffrey M">Jeffrey M</option>
    <option value="Josh">Josh</option>
    <option value="Kerwin">Kerwin</option>
    <option value="Lisa">Lisa</option>
    <option value="Monish">Monish</option>
    <option value="Nima">Nima</option>
    <option value="Paul">Paul</option>
    <option value="Phillip">Phillip</option>
    <option value="Rosy">Rosy</option>
    <option value="Seamus">Seamus</option>
    <option value="Tony">Tony</option>
    <option value="Yevin">Yevin</option>
  </select>
</div>

<!-- Manual Add Second -->
<div style="margin-bottom: 15px;">
  <label for="playerName"><strong>Or Add Player Manually:</strong></label><br>
  <input type="text" id="playerName" placeholder="Enter player name" />
  <button class="default-button" onclick="addPlayer()">Add Player</button>
</div>

  <div id="playersRemaining">Players remaining: 0</div>
  <div id="totalPot">Total Pot: $0</div>
  <ul id="playerList"></ul>
</div>

  <div class="player-section">
    <h2>Knockout Log</h2>
    <ul id="knockoutLog"></ul>
  </div>

<div class="player-section">
  <h2>Payout Breakdown</h2>
  <button class="default-button" onclick="showPayouts()">Show Payouts</button>
  <ul id="payoutList"></ul>
</div>

  
  <div class="level" id="blindLevel">Level 1: -- / --</div>
  <div class="timer" id="countdown">00:00</div>
<button id="startBtn" onclick="startTimer()">Start</button>
<button id="pauseBtn" onclick="pauseTimer()">Pause</button>
<button id="resetBtn" onclick="resetTimer()">Reset</button>

<script>
  let blindStructure = [];
  let currentLevel = 0;
  let timeRemaining = 0;
  let timerInterval;
  let running = false;
  let players = [];
  let knockoutOrder = [];
  let whistlePlayed = false;
  let buyInAmount = 0;

const savedPlayerNames = [
  "Andrew", "Cristian", "Dan", "Eddie", "Eduardo", "FrÃ©d", "Jamie", "Jason",
  "Jeffrey J", "Jeffrey M", "Josh", "Kerwin", "Lisa", "Monish", "Nima",
  "Paul", "Phillip", "Rosy", "Seamus", "Tony", "Yevin"
];
function toTitleCase(str) {
  return str
    .toLowerCase()
    .split(" ")
    .filter(word => word) // skip empty entries from double spaces
    .map(word => word.charAt(0).toUpperCase() + word.slice(1))
    .join(" ");
}

  
  function updateTotalPot() {
    const totalBuyIns = players.reduce((sum, p) => sum + p.buyins, 0);
    const total = totalBuyIns * buyInAmount;
    document.getElementById("totalPot").textContent = `Total Pot: $${total}`;
  }

  function addBlindLevel() {
  const small = parseInt(document.getElementById("smallBlind").value);
  const big = parseInt(document.getElementById("bigBlind").value);
  const durationMin = parseInt(document.getElementById("duration").value);
  const duration = durationMin * 60;

  if (!isNaN(small) && !isNaN(big) && !isNaN(duration)) {
    blindStructure.push({ level: blindStructure.length + 1, small, big, duration });
    updateBlindList();
    if (blindStructure.length === 1) {
      currentLevel = 0;
      timeRemaining = blindStructure[0].duration;
      updateDisplay();
    }
  }
}

function loadStandardPreset() {
  blindStructure = [
    { level: 1, small: 1, big: 2, duration: 1200 },
    { level: 2, small: 2, big: 5, duration: 1200 },
    { level: 3, small: 5, big: 10, duration: 1200 },
    { level: 4, small: 0, big: 0, duration: 300, break: true },
    { level: 5, small: 10, big: 25, duration: 1200 },
    { level: 6, small: 25, big: 50, duration: 1200 },
    { level: 7, small: 50, big: 100, duration: 1200 },
    { level: 8, small: 0, big: 0, duration: 300, break: true },
    { level: 9, small: 100, big: 200, duration: 1200 },
    { level: 10, small: 200, big: 400, duration: 1200 },
    { level: 11, small: 250, big: 500, duration: 1200 },
    { level: 12, small: 0, big: 0, duration: 300, break: true },
    { level: 13, small: 500, big: 1000, duration: 1200 },
    { level: 14, small: 1000, big: 2000, duration: 1200 },
    { level: 15, small: 2500, big: 5000, duration: 1200 },
  ];
  currentLevel = 0;
  timeRemaining = blindStructure[0].duration;
  updateBlindList();
  updateDisplay();

  // âœ… Add this block to hide custom blinds & update toggle button
  document.getElementById("blindSetup").style.display = "none";
  document.getElementById("toggleCustomBtn").textContent = "Show Custom Blind Setup";
}

  function deleteBlindLevel(index) {
    blindStructure.splice(index, 1);
    blindStructure.forEach((b, i) => b.level = i + 1);
    updateBlindList();
    if (currentLevel >= blindStructure.length) {
      currentLevel = 0;
      timeRemaining = blindStructure.length ? blindStructure[0].duration : 0;
      updateDisplay();
    }
  }

  function updateBlindList() {
    const ul = document.getElementById("blindList");
    ul.innerHTML = "";
    blindStructure.forEach((b, index) => {
      const li = document.createElement("li");
      li.innerHTML = b.break
  ? `Level ${b.level}: BREAK (${Math.floor(b.duration / 60)} min)`
  : `Level ${b.level}: ${b.small} / ${b.big} (${Math.floor(b.duration / 60)} min)`;

      const delBtn = document.createElement("button");
      delBtn.textContent = "Delete";
      delBtn.className = "delete-button";
      delBtn.onclick = () => deleteBlindLevel(index);
      li.appendChild(delBtn);
      ul.appendChild(li);
    });
  }

  function updateDisplay() {
    if (blindStructure.length === 0) return;
    const minutes = Math.floor(timeRemaining / 60).toString().padStart(2, '0');
    const seconds = (timeRemaining % 60).toString().padStart(2, '0');
    document.getElementById("countdown").textContent = `${minutes}:${seconds}`;
    const level = blindStructure[currentLevel];
    document.getElementById("blindLevel").textContent = `Level ${level.level}: ${level.small} / ${level.big}`;

    if (timeRemaining === 60 && !whistlePlayed) {
      document.body.classList.add("flash");
      const whistle = document.getElementById("whistleSound");
      whistle.volume = 1.0;
      whistle.play().catch(e => console.log("Audio play blocked:", e));
      whistlePlayed = true;
    }
  }

function startTimer() {
  if (running || blindStructure.length === 0) return;

  // ðŸš« Check if all players have paid
  const unpaidPlayers = players.filter(p => !p.paid);
  if (players.length === 0 || unpaidPlayers.length > 0) {
    alert("All players must be marked as paid before starting the timer.");
    return;
  }


  // ðŸ”Š Prime the whistle so it's allowed to play later
  const whistle = document.getElementById("whistleSound");
  try {
    whistle.play();
    whistle.pause();
    whistle.currentTime = 0;
  } catch (e) {
    console.log("Priming whistle failed:", e);
  }

  // â­ï¸ Advance to next level if timer is 0
  if (timeRemaining === 0) {
    currentLevel++;
    if (currentLevel >= blindStructure.length) {
      document.getElementById("countdown").textContent = "Tournament Over";
      return;
    }
    timeRemaining = blindStructure[currentLevel].duration;
    whistlePlayed = false;
    document.body.classList.remove("flash");
    updateDisplay();
  }

  running = true;

  timerInterval = setInterval(() => {
    if (timeRemaining > 0) {
      timeRemaining--;
      updateDisplay();

      // ðŸ”” Trigger whistle and flashing at 1 minute
      if (timeRemaining === 60 && !whistlePlayed) {
        document.body.classList.add("flash");
        try {
          whistle.play();
        } catch (e) {
          console.log("Whistle blocked:", e);
        }
        whistlePlayed = true;
      }

    } else {
      clearInterval(timerInterval);
      running = false;
      document.getElementById("countdown").textContent = "Level Complete â€“ Click Start to Continue";
    }
  }, 1000);
}

function showPayouts() {
  const payoutList = document.getElementById("payoutList");
  payoutList.innerHTML = "";

  if (!buyInAmount || isNaN(buyInAmount) || buyInAmount <= 0) {
    payoutList.innerHTML = "<li>Please enter a valid buy-in amount before adding players.</li>";
    return;
  }

  const totalPlayers = players.length;
  const totalBuyIns = players.reduce((sum, p) => sum + p.buyins, 0);
  const totalPot = totalBuyIns * buyInAmount;

  if (totalPlayers < 1) {
    payoutList.innerHTML = "<li>No players added yet.</li>";
    return;
  }

  let structure = [];
  if (totalPlayers <= 10) {
    structure = [0.5, 0.3, 0.2];
  } else if (totalPlayers <= 20) {
    structure = [0.5, 0.25, 0.15, 0.10];
  } else if (totalPlayers <= 30) {
    structure = [0.4, 0.25, 0.2, 0.1, 0.05];
  } else {
    payoutList.innerHTML = "<li>Too many players for preset payout table.</li>";
    return;
  }

  const places = ["1st", "2nd", "3rd", "4th", "5th"];
  structure.forEach((pct, i) => {
    const li = document.createElement("li");
    const amount = (totalPot * pct).toFixed(2);
    const percent = (pct * 100).toFixed(0);
    li.textContent = `${places[i]} Place (${percent}%): $${amount}`;
    payoutList.appendChild(li);
  });

  const totalLi = document.createElement("li");
  totalLi.style.marginTop = "10px";
  totalLi.style.fontWeight = "bold";
  totalLi.style.listStyle = "none";
  totalLi.textContent = `Total Pot: $${totalPot.toFixed(2)}`;
  payoutList.appendChild(totalLi);
}

 function pauseTimer() {
  if (timerInterval) {
    clearInterval(timerInterval);
    timerInterval = null;
    running = false;
    document.body.classList.remove("flash");
  }
}


  function resetTimer() {
    clearInterval(timerInterval);
    running = false;
    currentLevel = 0;
    document.body.classList.remove("flash", "celebrate");
    clearConfetti();
    if (blindStructure.length > 0) {
      timeRemaining = blindStructure[0].duration;
      updateDisplay();
    } else {
      document.getElementById("countdown").textContent = "00:00";
      document.getElementById("blindLevel").textContent = "Level 1: -- / --";
    }
  }

  function nextLevel() {
    currentLevel++;
    if (currentLevel >= blindStructure.length) {
      clearInterval(timerInterval);
      document.getElementById("countdown").textContent = "Tournament Over";
      document.body.classList.remove("flash");
      return;
    }
    timeRemaining = blindStructure[currentLevel].duration;
    whistlePlayed = false;
    document.body.classList.remove("flash");
    updateDisplay();
  }
  function addPlayer() {
  const nameInput = document.getElementById("playerName");
  const rawName = nameInput.value.trim();
  const name = toTitleCase(rawName);

  if (!buyInAmount) {
    const entered = parseFloat(document.getElementById("buyInValue").value);
    if (!isNaN(entered) && entered > 0) {
      buyInAmount = entered;
    } else {
      alert("Please enter a valid buy-in amount.");
      return;
    }
  }

  if (name && !players.some(p => p.name.toLowerCase() === name.toLowerCase())) {
    players.push({ name: name, buyins: 0, eliminated: false, paid: false, dealer: false });
    updatePlayerList();
    nameInput.value = "";

    savePlayerToLocal(name);  // âœ… now passing normalized
  }
}

function savePlayerToLocal(name) {
  let saved = JSON.parse(localStorage.getItem("savedPlayers")) || [];

  if (!saved.some(n => n.toLowerCase() === name.toLowerCase())) {
    saved.push(name);
    saved.sort((a, b) => a.toLowerCase().localeCompare(b.toLowerCase()));
    localStorage.setItem("savedPlayers", JSON.stringify(saved));
  }

  refreshSavedPlayersDropdown();  // âœ… this must always run
}

function refreshSavedPlayersDropdown() {
  const dropdown = document.getElementById("savedPlayers");
  const saved = JSON.parse(localStorage.getItem("savedPlayers")) || [];

  dropdown.innerHTML = `<option value="">-- Select Saved Player --</option>`;
  saved.forEach(name => {
    if (!players.some(p => p.name === name)) {
      const option = document.createElement("option");
      option.value = name;
      option.textContent = name;
      dropdown.appendChild(option);
    }
  });
}

function addSavedPlayer() {
  const select = document.getElementById("savedPlayers");
  const name = toTitleCase(select.value.trim());

  if (!buyInAmount) {
    const entered = parseFloat(document.getElementById("buyInValue").value);
    if (!isNaN(entered) && entered > 0) {
      buyInAmount = entered;
    } else {
      alert("Please enter a valid buy-in amount.");
      select.selectedIndex = 0;
      return;
    }
  }

  if (name && !players.some(p => p.name === name)) {
    players.push({ name: name, buyins: 0, eliminated: false, paid: false, dealer: false });
    updatePlayerList();

    // Remove selected option from the dropdown
    const selectedOption = select.querySelector(`option[value="${name}"]`);
    if (selectedOption) {
      selectedOption.remove();
    }

    // Reset dropdown back to placeholder
    select.selectedIndex = 0;
  }
}

function updatePlayerList() {
  const list = document.getElementById("playerList");
  list.innerHTML = "";
  players.forEach((player, index) => {
    const li = document.createElement("li");
    li.className = player.eliminated ? "eliminated" : "";

    const nameSpan = document.createElement("span");
    nameSpan.textContent = player.name;

    // ðŸ‚¡ Card icon
    const cardIcon = document.createElement("span");
    cardIcon.textContent = " ðŸ‚¡";
    cardIcon.title = "Dealer";
    cardIcon.style.display = player.dealer ? "inline" : "none";

    // Dealer checkbox
   const dealerLabel = document.createElement("label");
dealerLabel.style.marginLeft = "10px";
dealerLabel.style.cursor = "pointer";

const dealerCheckbox = document.createElement("input");
dealerCheckbox.type = "checkbox";
dealerCheckbox.checked = player.dealer;
dealerCheckbox.disabled = player.eliminated;
dealerCheckbox.style.marginRight = "5px";
dealerCheckbox.onchange = () => {
  player.dealer = dealerCheckbox.checked;
  cardIcon.style.display = dealerCheckbox.checked ? "inline" : "none";
  updatePlayerList();
};

dealerLabel.appendChild(dealerCheckbox);
dealerLabel.appendChild(document.createTextNode("Dealer"));


    const paidIcon = document.createElement("span");
    paidIcon.textContent = player.paid ? "ðŸ’°" : "ðŸ’¸";
    paidIcon.style.cursor = "pointer";
    paidIcon.title = player.paid ? "Click to mark unpaid" : "Click to mark paid";
    paidIcon.style.marginLeft = "10px";
    paidIcon.style.pointerEvents = player.eliminated ? "none" : "auto";
    paidIcon.style.opacity = player.eliminated ? "0.5" : "1";
    paidIcon.onclick = () => {
      player.paid = !player.paid;
      player.buyins = player.paid ? 1 : 0;
      updatePlayerList();
    };

    const buyinsText = document.createTextNode(` - Buy-ins: ${player.buyins}`);

    // Append all UI parts in order
    li.appendChild(nameSpan);
    li.appendChild(cardIcon);
    li.appendChild(dealerLabel);
    li.appendChild(paidIcon);
    li.appendChild(buyinsText);

    const buyBtn = document.createElement("button");
buyBtn.textContent = "+1 Re-buy";
buyBtn.className = "buyin-button";
buyBtn.onclick = () => addBuyin(index);
buyBtn.disabled = player.eliminated;

const koBtn = document.createElement("button");
koBtn.textContent = player.eliminated ? "Undo KO" : "Knock Out";
koBtn.className = "knockout-button";
koBtn.onclick = () => toggleElimination(index);

const removeBtn = document.createElement("button");
removeBtn.textContent = "Remove";
removeBtn.className = "delete-button";
removeBtn.onclick = () => removePlayer(index);
removeBtn.disabled = player.eliminated;


    li.appendChild(buyBtn);
    li.appendChild(koBtn);
    li.appendChild(removeBtn);

    list.appendChild(li);
  });

  updateRemainingCount();
  updateKnockoutLog();
  updateTotalPot();
}


  function updateRemainingCount() {
    const remaining = players.filter(p => !p.eliminated).length;
    document.getElementById("playersRemaining").textContent = `Players remaining: ${remaining}`;
    if (remaining === 1 && players.length > 1) {
      const winner = players.find(p => !p.eliminated);
      celebrateWinner(winner.name);
    }
  }

  function updateKnockoutLog() {
    const log = document.getElementById("knockoutLog");
    log.innerHTML = "";
    knockoutOrder.forEach((name, i) => {
      const li = document.createElement("li");
      li.textContent = `#${i + 1}: ${name}`;
      log.appendChild(li);
    });
  }

  function addBuyin(index) {
    players[index].buyins++;
    updatePlayerList();
  }

  function toggleElimination(index) {
    const player = players[index];
    player.eliminated = !player.eliminated;
    if (player.eliminated) {
      knockoutOrder.push(player.name);
    } else {
      knockoutOrder = knockoutOrder.filter(name => name !== player.name);
    }
    updatePlayerList();
  }

  function celebrateWinner(name) {
    alert(`${name} is the winner!`);
    document.body.classList.add("celebrate");
    startConfetti();
    document.getElementById("winSound").play().catch(() => {});
  }

  // Simple confetti animation
  let confettiInterval;
  function startConfetti() {
    const canvas = document.getElementById("confetti-canvas");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    const ctx = canvas.getContext("2d");
    let confetti = Array.from({length: 100}, () => ({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height,
      r: Math.random() * 6 + 4,
      d: Math.random() * 50 + 10,
      color: `hsl(${Math.random() * 360}, 100%, 50%)`,
      tilt: Math.random() * 10 - 5
    }));
    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      confetti.forEach((c, i) => {
        ctx.beginPath();
        ctx.lineWidth = c.r;
        ctx.strokeStyle = c.color;
        ctx.moveTo(c.x + c.tilt, c.y);
        ctx.lineTo(c.x, c.y + c.tilt);
        ctx.stroke();
        c.y += Math.cos(c.d) + 1 + c.r / 2;
        c.x += Math.sin(0);
        if (c.y > canvas.height) {
          confetti[i] = {
            x: Math.random() * canvas.width,
            y: -10,
            r: c.r,
            d: c.d,
            color: c.color,
            tilt: c.tilt
          };
        }
      });
    }
    confettiInterval = setInterval(draw, 20);
  }

  function clearConfetti() {
    clearInterval(confettiInterval);
    const canvas = document.getElementById("confetti-canvas");
    const ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, canvas.width, canvas.height);
  }

  function toggleCustomBlind() {
  const setup = document.getElementById("blindSetup");
  const toggleBtn = document.getElementById("toggleCustomBtn");

  if (setup.style.display === "none") {
    setup.style.display = "block";
    toggleBtn.textContent = "Hide Custom Blind Setup";
  } else {
    setup.style.display = "none";
    toggleBtn.textContent = "Show Custom Blind Setup";
  }
}
window.addEventListener("DOMContentLoaded", () => {
  const initialDefaults = [
  "Andrew", "Cristian", "Dan", "Eddie", "Eduardo", "FrÃ©d", "Jamie", "Jason",
  "Jeffrey J", "Jeffrey M", "Josh", "Kerwin", "Lisa", "Monish", "Nima",
  "Paul", "Phillip", "Rosy", "Seamus", "Tony", "Yevin"
];

  const existing = JSON.parse(localStorage.getItem("savedPlayers"));
  if (!existing || !Array.isArray(existing)) {
    localStorage.setItem("savedPlayers", JSON.stringify(initialDefaults));
  }

  refreshSavedPlayersDropdown();
  loadInputs();                  
});


function removePlayer(index) {
  players.splice(index, 1);               // Remove from player list
  updatePlayerList();                     // Refresh UI
  refreshSavedPlayersDropdown();          // Rebuild dropdown
}

function calculateDealerSplit() {
  const dealerFee = parseFloat(document.getElementById("dealerFeeDealer").value);
  if (isNaN(dealerFee) || dealerFee <= 0) {
    alert("Please enter a valid dealer fee.");
    return;
  }

  const dealers = players.filter(p => p.dealer);
  if (dealers.length === 0) {
    alert("Please mark at least one player as a dealer.");
    return;
  }

  const payingPlayers = players.filter(p => !p.dealer);
  const totalCollected = dealerFee * payingPlayers.length;
  const payoutPerDealer = totalCollected / dealers.length;

  const dealerNames = dealers.map(p => p.name).join(", ");
  const resultText = `Total: $${totalCollected.toFixed(2)} | Each Dealer (${dealerNames}): $${payoutPerDealer.toFixed(2)}`;
  document.getElementById("dealerResult").textContent = resultText;
}
function saveInputs() {
  const inputData = {
    buyInValue: document.getElementById("buyInValue").value,
    smallBlind: document.getElementById("smallBlind").value,
    bigBlind: document.getElementById("bigBlind").value,
    duration: document.getElementById("duration").value,
    dealerFee: document.getElementById("dealerFeeInput").value
  };
  localStorage.setItem("pokerInputs", JSON.stringify(inputData));
}

function loadInputs() {
  const saved = JSON.parse(localStorage.getItem("pokerInputs"));
  if (!saved) return;

  document.getElementById("buyInValue").value = saved.buyInValue || "";
  document.getElementById("smallBlind").value = saved.smallBlind || "";
  document.getElementById("bigBlind").value = saved.bigBlind || "";
  document.getElementById("duration").value = saved.duration || "";
  document.getElementById("dealerFeeInput").value = saved.dealerFee || "";
}
function clearAllInputs() {
  if (!confirm("Are you sure you want to clear all saved inputs?")) return;

  localStorage.removeItem("pokerInputs");

  document.getElementById("buyInValue").value = "";
  document.getElementById("smallBlind").value = "";
  document.getElementById("bigBlind").value = "";
  document.getElementById("duration").value = "";
  document.getElementById("dealerFeeInput").value = "";
  document.getElementById("dealerFeeDealer").value = "";
}

  
</script>
</body>
</html>
